FORLIBRARY = stringUtils.o caesarXor.o

LIBRARY = libDecDyn.so

TARGET = encoder

all: encoder

$(TARGET): encoder.o libDecDyn.so
	gcc encoder.o -o encoder -std=c99 -L. -lDecDyn -Wl,-rpath,. -Wall -Werror
	rm stringUtils.o caesarXor.o encoder.o

encoder.o: coders/encoder.c
	gcc $< -c -std=c99 -Wall -Werror

$(LIBRARY): $(FORLIBRARY)
	gcc  stringUtils.o caesarXor.o -shared -o $(LIBRARY)

stringUtils.o: modules/stringUtils.c
	gcc -c -fPIC $< -std=c99 -Wall -Werror

caesarXor.o: modules/caesarXor.c
	gcc -c -fPIC $< -std=c99 -Wall -Werror

clean:
	rm -rf *.o $(TARGET)
	rm -rf *.so $(TARGET)