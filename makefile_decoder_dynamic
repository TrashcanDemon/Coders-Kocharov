FORLIBRARY = upperlower.o strip.o caesar.o xor.o

LIBRARY = libDecDyn.so

TARGET = decoder

all: decoder

$(TARGET): decoder.o libDecDyn.so
	gcc decoder.o -o decoder -std=c99 -L. -lDecDyn -Wl,-rpath,. -Wall -Werror
	rm upperlower.o strip.o caesar.o xor.o decoder.o

decoder.o: coders/decoder.c
	gcc $< -c -std=c99 -Wall -Werror

$(LIBRARY): $(FORLIBRARY)
	gcc  upperlower.o strip.o caesar.o xor.o -shared -o $(LIBRARY)

upperlower.o: modules/upperlower.c
	gcc -c -fPIC $< -std=c99 -Wall -Werror

strip.o: modules/strip.c
	gcc -c -fPIC $< -std=c99 -Wall -Werror

caesar.o: modules/caesar.c
	gcc -c -fPIC $< -std=c99 -Wall -Werror

xor.o: modules/xor.c
	gcc -c -fPIC $< -std=c99 -Wall -Werror

clean:
	rm -rf *.o $(TARGET)
	rm -rf *.so $(TARGET)